<?xml version="1.0" encoding="UTF-8"?>
<!-- 
This build file separates out the findbugs target so that build.xml
does not require a developer to have findbugs installed.
-->

<project name="mifos-findbugs" default="findbugs" basedir=".">

	<import file="build.xml"/>

	<taskdef name="findbugs" classname="edu.umd.cs.findbugs.anttask.FindBugsTask"/>

	<property name="tools.dir" value="${basedir}/tools/" />
	<property name="findbugs.reportlevel" value="low" />
	<property name="findbugs.home" value="${tools.dir}/findbugs-1.1.1" />

	<target name="findbugs" depends="compile,compile_test,copy_files,copy_test_files"
		description="Runs Findbugs on the MIFOS application and unit test class files." >
		<findbugs home="${findbugs.home}"
				  jvmargs="-Xmx512m"
	              output="xml"
				  warningsProperty="findbugs.generated.warnings"
				  reportlevel="${findbugs.reportlevel}"
			  	  excludefilter="${conf.dir}/findbugs.filter.xml"
	              outputFile="${dist.dir}/mifos.findbugs.output.xml" >
			<auxClasspath>
				<fileset dir="${basedir}">
				    <include name="**/*.jar"/>
				</fileset>
			</auxClasspath>
			<sourcePath path="${src.dir}" />
			<class location="${build.dir}" />
		</findbugs>
		<fail if="findbugs.generated.warnings" 
		message="Findbugs generated warnings"/>
	</target>
	
	<target name="dist_findbugs" 
		depends="clean,compile,copy_files,compile_test,copy_test_files,findbugs,run_test,war,deploy" 
		description="Compiles, runs test, builds a distributable war and places in the dist directory. Copies to the web server in use. Does not rebuild the production database"
	/>
	
</project>
