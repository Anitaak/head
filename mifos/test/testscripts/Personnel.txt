Function Main

    ; Remove the comment below to "Enable" error handling
    ; On Error Call OnErrorHandler

Attach "PopupWindow~1"
   Button "Start", 'Left SingleClick'
   PopupMenuSelect "Run..." 
   Pause 3, 'Seconds'
    
Attach "Run PopupWindow"     
   ComboText "&Open:", "iexplore"
   Button "OK", 'Left SingleClick'

Attach "about:blank - Microsoft Internet Explorer MainWindow"
   EditClick "~1", 'Left SingleClick', 39, 8 
   Pause 3, 'Seconds'
   ret = PromptBox( "URL", "Enter URL",value)
   ComboText "~1", value
   TypeToControl "Edit", "~1", "{Return}"
Login()
testdata ( "c:\Personal.csv" ,chr(44), chr(13) + chr(10))
n=testDataCurField() 
i=0
Csv()
End Function ; Main
Function Csv
if(TestDataCurRecord( ) = TestDataRecordCount( ))
RecordEnd()
else
i=i+1
PersonalCreation()
EndIf
End Function ; Csv

Function PersonalCreation
ret1=TestDataField( i, 1 )
ret2=TestDataField( i, 2 )
ret3=TestDataField( i, 3 )
ret4=TestDataField( i, 4 )
ret5=TestDataField( i, 5 )
ret6=TestDataField( i, 6 )
ret7=TestDataField( i, 7 )
ret8=TestDataField( i, 8 )
ret9=TestDataField( i, 9 )
ret10=TestDataField( i, 10 )
ret11=TestDataField( i, 11 )
ret12=TestDataField( i, 12 )
ret13=TestDataField( i, 13 )
ret14=TestDataField( i, 14 )
ret15=TestDataField( i, 15 )
ret16=TestDataField( i, 16 )
ret17=TestDataField( i, 17 )
ret18=TestDataField( i, 18 )
ret19=TestDataField( i, 19 )
ret20=TestDataField( i, 20 )
ret21=TestDataField( i, 21 )

Attach "Mifos - Microsoft Internet Explorer MainWindow"
Attach "Mifos ChildWindow"
AnchorSelect "Admin", 'Left SingleClick'
AnchorSelect "Define new system user", 'Left SingleClick'
AnchorSelect ret1, 'Left SingleClick'
EditText "personnelDetails.firstName", ret2
EditText "personnelDetails.lastName", ret3
EditText "personnelDetails.governmentIdNumber", ret4
EditText "(MM)", ret5
EditText "(MM)~2", ret6
EditText "(DD)", ret7
ComboBox "personnelDetails.gender", ret8, 'Left SingleClick'
EditText "(MM)~3", ret9
EditText "(MM)~4", ret10
EditText "(DD)~2", ret11
EditText "personnelDetails.address1", ret12
EditText "personnelDetails.city", ret13
EditText "personnelDetails.state", ret14
EditText "personnelDetails.country", ret15
EditText "personnelDetails.postalCode", ret16
ComboBox "level.levelId", ret17, 'Left SingleClick'
ListBox "LeftSelect", ret18, 'Left SingleClick With Shift'
Button ">>", 'Left SingleClick'
EditText "userName", ret19
EditText "password", ret20
EditText "passwordRepeat", ret21
Button "Preview", 'Left SingleClick'
TypeToControl "Static", "First Name: Sreedhar ...", "{Ctrl {ExtEnd}}"
Button "Submit", 'Left SingleClick'

Anchorselect "Add a new user",'Left SingleClick'
Csv()
End Function


Function Login
Attach "Mifos - Microsoft Internet Explorer MainWindow"
Attach "Mifos ChildWindow"
    EditText "userName", "mifos"
    EditText "password", "mifos"
    Button "Login", 'Left SingleClick'
End Function
Function RecordEnd
Anchorselect "Logout",'Left SingleClick'
logcomment "No Of Records Exceeded"

End Function

Function OnErrorHandler

    ;
    ; Insert your Error handling code here.
    ;
    Resume Next ; Continue On Error

End Function

