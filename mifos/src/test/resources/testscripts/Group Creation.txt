Function Main 
#comment
    ; Remove the comment below to "Enable" error handling
    ; On Error Call OnErrorHandler

Attach "Popupwindow~1"
    Button "start",'Left SingleClick'
    PopupMenuSelect "Run..."
Attach "Run Popupwindow" 
    ComboText "&open:","iexplore"
    pause 4,'seconds'
    button "OK",'Left singleClick'

Attach "about:blank - Microsoft Internet Explorer MainWindow"
    EditClick "~1", 'Left SingleClick', 96, 6
    ComboText "~1", "http://aditi501/mifos/index.htm"
    TypeToControl "Edit", "~1", "{Return}"
    Groups()
End Function ; Main

Function Groups()
    Anchorselect "Create new group",'Left SingleClick'
    window1=Activewindow()
    Attach window1
    result1=Check ("Group-Center Selection")
    if result1=1
    EditText "textfield222","Sadashiva"
    button "Search",'Left SingleClick'
    window2=Activewindow()
    attach window2
    anchorselect "Kanakpura Center Phase 1",'Left SingleClick'
    GroupInformation()
    else
    Gerror()
    Endif
    

End Function
Function GroupInformation()
    window3=activewindow()
    attach window3
    EditText "textfield22","Sadashiva Nagar"
    checkbox "checkbox",'Left SingleClick'
    EditText "MM", "12"
    EditText "MM~2", "12"   
    EditText "DD", "05"
    EditText "textfield2422222","iamsreedhar@gmail.com"
    ListBox "select", "Program 3", 'Left SingleClick'
    Button "Add >>", 'Left SingleClick'
    EditText "textfield2432","Martha Halli"
    EditText "textfield2442","Mathakeri"    
    EditText "textfield24422","BTM Layout"
    EditText "textfield2452","Banglore"
    EditText "textfield2462","Karnataka"
    EditText "textfield2472","India"
    EditText "textfield2482","560080"
    EditText "textfield2492","9886661109"    
    EditText "textfield242222","Mifos"
    EditText "textfield2422223","MFI"
    EditText "MM~3", "12"
    EditText "MM~4", "12"   
    EditText "DD~2", "05"
    EditText "textfield24224","MFI"
    EditText "textfield2422224","Sree"
    EditText "textfield242242","dhar"
    EditText "textfield242243222","300"
    Checkbox "Check to Remove~2", 'Left SingleClick'
    ComboBox "select5", "Training Fee", 'Left SingleClick'
    EditText "textfield24224322","200"
    ComboBox "select3~1", "Training Fee", 'Left SingleClick'
    EditText "textfield24224323","200"
    ComboBox "select3~2", "Training Fee", 'Left SingleClick'
    EditText "textfield2422432","200"
    Preview()
    winname5=activewindow()
    attach winname5
    Submit()
    Anchorselect "Create a new group"
  
End Function
Function Gerror()
    Logcomment("Test Fail")
    Anchorselect "Clients & Accounts",'Left SingleClick'
    Groups()
End Function
Function Preview()
    winname3=activewindow()
    Attach winname3
    result1=Check ("Center")
    if result1=1
    button "Preview" ,'Left singleClick'
    else
    Gerror()
    Endif
End Function

Function Submit()
    winname4=activewindow()
    Attach winname4
    result2=Check("Submit")
    if result2=1
    Type "{Ctrl {ExtEnd}}"
    Button "Submit for approval", 'Left SingleClick'
    else
    Gerror()
    Endif

End Function


Function OnErrorHandler

    ;
    ; Insert your Error handling code here.
    ;
    Resume Next ; Continue On Error

End Function
