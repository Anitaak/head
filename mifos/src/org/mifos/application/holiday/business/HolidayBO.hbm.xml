<?xml version="1.0" encoding='UTF-8'?>
<!DOCTYPE hibernate-mapping PUBLIC
                            "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
                            "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd" >


<hibernate-mapping>

	<class name="org.mifos.application.holiday.business.HolidayBO" table="HOLIDAY">
		<composite-id
		        name="holidayPK"
		        class="org.mifos.application.holiday.business.HolidayPK" >
		        <key-property name="officeId" column="OFFICE_ID" type="short" />
		        <key-property name="holidayFromDate" column="HOLIDAY_FROM_DATE" type="date" />
	    </composite-id>

	    <property name="holidayThruDate" column="HOLIDAY_THRU_DATE" type="date" />
		<property name="holidayName" column="HOLIDAY_NAME" type="string" />
		<property name="repaymentRuleId" column="REPAYMENT_RULE_ID" type="short"/>
		<property name="holidayChangesAppliedFlag" column="HOLIDAY_CHANGES_APPLIED_FLAG"/>        
	</class>

	<!-- Holiday Specific Queries  -->
	<query name="holiday.getHolidays">
   	       <![CDATA[select new org.mifos.application.holiday.business.HolidayBO(holidayBO.holidayPK, 
   	       				   holidayBO.holidayThruDate, holidayBO.holidayName, lvl.localeId, 
   	       				   holidayBO.repaymentRuleId, lvl.lookUpValue)
 			          from org.mifos.application.holiday.business.HolidayBO holidayBO,
 			               org.mifos.application.holiday.business.RepaymentRuleEntity repaymentRule,
			               org.mifos.application.master.business.LookUpValueLocaleEntity lvl 
                     where lvl.lookUpId = repaymentRule.lookUpValue.lookUpId 
                       and lvl.localeId = :LOCALE_ID
                       and holidayBO.repaymentRuleId = repaymentRule.id
		               and holidayBO.holidayPK.holidayFromDate >= :START_OF_YEAR
                       and holidayBO.holidayPK.holidayFromDate <= :END_OF_YEAR
   	       ]]>
	</query>
	<query name="holiday.getHoildaysByFlag">
			<![CDATA[from org.mifos.application.holiday.business.HolidayBO holidayBO
	                  where holidayBO.holidayChangesAppliedFlag = :FLAG
			]]>
	</query>

</hibernate-mapping>